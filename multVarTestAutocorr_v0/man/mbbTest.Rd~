\name{mbbTest}
\alias{mbbTest}
\alias{mbbTest.default}
\title{
Moving Blocks Bootstrapping Test
}
\description{
Moving blocks bootstrapping resampling test for differences of means that accounts for temporal and spatial correlation. After Wilks (1997).
}
\usage{
mbbTest(x, ...)

\method{mbbTest}{default}(x, y, L = 1, siglev = 0.05, alpha = 0.05, nb = 1000, verbose = FALSE, timevals = NULL, ...)
}

\arguments{
  \item{x}{a (non-empty) numeric array of data values with dimensions longitude, latitude, time where time is autocorrelated AR(1)
}
  \item{y}{an optional (non-empty) numeric array of data values with dimensions longitude, latitude, time where time is autocorrelated AR(1)
}
  \item{L}{optional block length, if not given estimated by \eqn{L=(n-L+1)^{\frac{2}{3})(1-\frac{1}{V'})}}{L=(n-L+1)^((2/3)(1-1/V'))} 
}
  \item{siglev}{local significance level
}
  \item{alpha}{global significance level
}
  \item{nb}{number of bootstrapping samples
}
  \item{verbose}{logical, if TRUE every 100 bootstrap is reported
}
  \item{timevals}{optional number of timevales in the x (y) timeseries. If provided the function checks for correct dimensions.
}
  \item{\dots}{further arguments to be passed to or from methods, not used at the moment.
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{
A list with class \code{mbbtest} containing the following components:
  \item{estimate }{the estimated difference in means}
  \item{loc.sig }{numeric value of local significance level}
  \item{field.sig }{numeric value of field significance level alpha}
  \item{h.value }{longitude x latitude array with results for local signficance test (1=significant)}
  \item{h.valueFS }{longitude x latitude array with results for field signficiance}
  \item{nr.sigpt }{number of significant grid points}
  \item{total.test }{total number of tests}
  \item{loc.sig.coverage }{coverage of local significance, nr.sigpt/total.test}
  \item{FS }{logical for field significance}
  \item{nboot }{number of bootstarps}
  \item{method }{string with name of the method}
  \item{call }{how the function was called}

}
\references{
Wilks, D.S., 1997, Resampling Hypothesis Tests for Autocorrelated Fields, J. Clim., \bold{10}, p.65--82.

}
\author{
Ruth Lorenz
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
x<-array(NA,dim=c(20,50,31))
y<-array(NA,dim=c(20,50,31))

for (lon in 1:20){
	for (lat in 1:50){
		#create timeseries with AR(1) correlation
		x[lon,lat,]<-arima.sim(list(ar = 0.3),n=31,rand.gen=rnorm,sd=0.1,mean=0)
		y[lon,lat,]<-arima.sim(list(ar = 0.3),n=31,rand.gen=rnorm,sd=0.1,mean=0)
	}
}
mbb <- mbbTest(x,y,siglev=0.05,nb=10,verbose=FALSE)
print(mbb)

## The function is currently defined as
function (x, ...) 
UseMethod("mbbTest")
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ multivariate }
\keyword{ ts }
